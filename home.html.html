<!-- 1. add using http call 
2. decide on what to show
3. add head title
4. LOGOUT AUTO NEEDS TO BE ADDED - https://developers.google.com/identity/sign-in/web/sign-in
5. Server side vs client side api - whats the need ? - https://developers.google.com/identity/protocols/oauth2/javascript-implicit-flow
6. User verification token? - After a user successfully signs in, get the user's ID token: / https://developers.google.com/identity/sign-in/web/backend-auth
7. Google Domain -> Forward to Github pages site -> Functions  -> Google API
8. Setup Heroku Later
9. // NODEMON
10. Bootstrap / materialize
11. Add code to function - add everthing and then module.exports - https://stackoverflow.com/questions/59868667/how-to-deploy-express-js-server-to-netlify
12. https://www.w3schools.com/tags/tag_nav.asp
13. Remove https://www.google.com/search?q=getting+2+slashes+at+end+of+site&oq=getting+2+slashes+at+end+of+site&aqs=chrome..69i57.13170j1j4&client=ms-android-hmd-rev2&sourceid=chrome-mobile&ie=UTF-8
14. Make demo.pictures HTTPS
15. server vs client oauth
16. Get refresh token fro server side flow
17. dotenv
18. Push to a ref - The app initiates the flow by crafting a URL containing ID, and optionally scope and state. The app can put this into an <a href=""> tag.
	- https://www.oauth.com/oauth2-servers/single-page-apps/
	- https://medium.com/@jackrobertscott/how-to-use-google-auth-api-with-node-js-888304f7e3a0

19. Text box labels and exmaple code to show whats happening - placeholder text
20-. https://www.youtube.com/watch?v=Q4RiI7bvpso
21. https://www.w3schools.com/tags/tag_input.asp - Button Placeholders
22. Open auth url outside the main page
23. convert to extension
	---------------------------------------------------------------------

Looks like client side implicit flow is for quick authorization and no refrsh token as no client secret is used,
whereas for server side it would require a client secret from application server of the developer

https://stackoverflow.com/questions/8142717/when-should-the-server-side-vs-client-side-facebook-authentication-flows-be-use
https://stackoverflow.com/questions/11571849/oauth-2-server-side-vs-client-side
https://stackoverflow.com/questions/9067947/facebook-access-token-server-side-vs-client-side-flows

Client side - browser based quick authorization and temporary access to user's resources
Server side - server based long term authorization, saving access token for multiple use

Main confusion is, do we need a server for both, YES -- since a valid redirect URL is required !!

---------------------------------------------------------------------

Maybe the server side chrome extension can show it's own code to the dev to show how it would be, yea thats ok.
client secret having place holder code to show how code is....test require the JS file and export in response.
 -->


<!DOCTYPE HTML>
<html>
	<body>
	<head>
		<link rel="stylesheet" type="text/css" href="main.css" media="screen"/>
	</head>
	</body>
		<p>API Data Explorer</p>
		<div class="buttonDiv">
			<label>Your Cloud Function URL</label>
			<input class = "inputText" id="cloudFunctionURL"></input>
			<br>
			<br>
			<label>Your API Key</label>
			<input class = "inputText" id="apikey"></input>
			<br>
			<br>
			<label>Your Client ID</label>
			<input class = "inputText" id="clientid"></input>
			<br>
			<br>
			<label>Your Client Secret</label>
			<input class = "inputText" id="clientSecret"></input>
			<br>
			<br>
			<button class = "buttonclass" id = "authAndLoadButton" onclick="authAndLoad()">Authorize & Load</button>
			<button class = "buttonclass" id = "executeButton" onclick="execute()">Call API</button>
		</div>
		<br>
		<br>
		<div id="fetchUpdateDiv"></div>
		<div>
			<a id="googAuthResponseURL"></a>
		</div>
		<script>
			
			let div = document.getElementById("fetchUpdateDiv");
			let body = {};
			
			function authAndLoad(){
				let result = validateForms();

				if(result){
					div.innerHTML = "";
					let loaderDiv = document.createElement("div");
					loaderDiv.className = "loader";
					document.body.insertAdjacentElement('afterend', loaderDiv);

					fetch(document.getElementById("cloudFunctionURL").value.toString(),{
						// fetch("http://localhost:8888",{
						method: 'POST',
						// headers have to be added as new headers!
						headers: new Headers(
							{
								'Content-Type': 'application/json',
								// https://stackoverflow.com/questions/1256593/why-am-i-getting-an-options-request-instead-of-a-get-request
								// this fixed our problem, changing from "application/json" to "text/plain" stopped the horrible options request â€“ Keeno Jul 12 '13 at 9:44
								// the two below did nothing! Might want to setup this in function
								// 'Access-Control-Allow-Methods': 'POST',
    							// 'Access-Control-Allow-Headers': 'Content-Type'
							}),
						body: JSON.stringify(body),
						mode: 'cors'
					})
					.then((response)=>{
						// had to use response.text and not response.json since server sending response as text/html
						return response.text();
					// fetch promise needs to be resolved to get the server response
						}).then((jsonload)=>{
							if(jsonload.length > 45 && jsonload.slice(0,45) == 'https://accounts.google.com/o/oauth2/v2/auth?'){
								resetTextColor();
								loaderDiv.remove();
								resetTextColor();
								document.getElementById('googAuthResponseURL').innerHTML = "Click to Authorize";
								document.getElementById('googAuthResponseURL').href = jsonload;
							}
							else{
								resetTextColor();
								loaderDiv.remove();
								resetTextColor();
								div.innerHTML = jsonload;
							}
						}).catch((err)=>{
							resetTextColor();
							loaderDiv.remove();
							// loaderDiv.style.display = "none";
							div.innerHTML = err;
						});
				}
			}

			function validateForms(){
				let apikey = document.getElementById("apikey").value;
				let clientid = document.getElementById("clientid").value;
				let clientSecret = document.getElementById("clientSecret").value;

				if(apikey == '' || clientid == '' ||  clientSecret == ''){
					div.innerHTML = "Error!";
					div.style.color = "red";
					return false;
				}
				else{
					body = {
						key : apikey,
						id : clientid,
						secret : clientSecret
					}
					return true;
				}
			}

			function execute(){
				div.innerHTML = "API Called";
				resetTextColor();
			}

			function resetTextColor(){
				div.style.color = "";
			}

		</script>
		<br></br>
</html>